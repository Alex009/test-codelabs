
<!doctype html>

<html>
<head>
  <meta name="viewport" content="width=device-width, minimum-scale=1.0, initial-scale=1.0, user-scalable=yes">
  <meta name="theme-color" content="#4F7DC9">
  <meta charset="UTF-8">
  <title>IceRock KMM onboarding #1 - разворачивание проекта</title>
  <link rel="stylesheet" href="//fonts.googleapis.com/css?family=Source+Code+Pro:400|Roboto:400,300,400italic,500,700|Roboto+Mono">
  <link rel="stylesheet" href="//fonts.googleapis.com/icon?family=Material+Icons">
  <link rel="stylesheet" href="https://storage.googleapis.com/codelab-elements/codelab-elements.css">
  <style>
    .success {
      color: #1e8e3e;
    }
    .error {
      color: red;
    }
  </style>
</head>
<body>
  <google-codelab-analytics gaid="UA-49880327-14"></google-codelab-analytics>
  <google-codelab codelab-gaid=""
                  id="kmm-icerock-onboarding-1-ru"
                  title="IceRock KMM onboarding #1 - разворачивание проекта"
                  environment="web"
                  feedback-link="https://github.com/icerockdev/kmp-codelabs/issues">
    
      <google-codelab-step label="Вводная" duration="5">
        <p>Привет! Если ты это читаешь, значит ты начинаешь погружаться в процессы мультиплатформенной разработки в IceRock.</p>
<p>Мы активно применяем и продвигаем этот подход с 2017-2018 годов. Основная его ценность для нас - это возможность объединения бизнес-логики приложения в одном месте для обеих платформ. Вместо того, чтобы отлаживать и реализовывать логику отдельно для iOS и Android мы пишем общий код, который используют обе платформы. Один и тот же код. Соответственно, баги, связанные с некорректной логикой, не будут плавать с платформы на платформу. И не потребуется отвлекать разных разработчиков - проблемы в логике могут быть исправлены одним человеком, в одном месте и починить сразу и iOS, и Android. Круто же)</p>
<p>При этом взаимодействие с пользователем остаётся 100% нативным. Доступен полный набор всех средств, которые предоставляют нативные SDK. Юзер использует привычные элементы и приложение ведёт себя так, как привыкли пользователи каждой платформы.</p>
<p>Обратная сторона медали - сложности на первых порах, при вхождении в такой подход и метод разработки. Для андроид-разработчиков особо ничего не меняется - они могут использовать всё тот же Kotlin, модульность, Gradle, корутины и прочие незнакомые большинству iOS-ников вещи. А iOS-разработчик, в свою очередь, попадая впервые на мультиплатформенный проект, едет кукухой от того, что в проект подцепляется какой-то мультиплатформенный под-чёрный-ящик, в котором какая-то куча вьюмоделей, реализующих внутри магию с логикой, кругом какие-то диспатчеры, юниты, экран со сложной вёрсткой в контроллере состоит из таблицы и нескольких строчек биндинга,не понятно откуда что берётся и вопросов больше, чем ответов.</p>
<p>На самом же деле всё довольно просто и логично. Сгруппировано, разбито и структурировано. Но вникнуть в эту концепцию придя на уже живущий проект, находящийся в активной разработке сложно из-за большого объёма информации и логики.</p>
<p>Поэтому данный гайд призван помочь пройтись по шагам по основным практически моментам, ежедневно встречающимся в нашей повседневной разработке. В нём ты сможешь по очереди выполнять задания, наращивать функционал тестового проекта и изучать устройство проекта изнутри.</p>
<p>Здесь не будет детального разбора теоретической части, т.к. по ней уже имеется большое количество статей и документации, к которым можно обращаться в процессе. Здесь ты именно закрепляешь на практике теоретические знания из статей. Так что наливай чаёк-кофеёк и поехали)</p>
<p>Материалы для ознакомления перед началом:</p>
<ul>
<li><a href="https://kotlinlang.org/lp/mobile/" target="_blank">Портал Kotlin Multiplatform Mobile</a></li>
<li><a href="https://kotlinlang.org/docs/mobile/home.html" target="_blank">Документация по Kotlin Multiplatform Mobile</a></li>
<li><a href="https://www.youtube.com/playlist?list=PLlFc5cFwUnmy_oVc9YQzjasSNoAk4hk_C" target="_blank">Видео для начинающих от JetBrains</a></li>
</ul>


      </google-codelab-step>
    
      <google-codelab-step label="Подготовка общего кода" duration="10">
        <p>Для начала нужно подготовить окружение для работы с Kotlin Multiplatform. Подробная инструкция доступна на нашем сайте <a href="https://kmm.icerock.dev/pages/2-setup/" target="_blank">kmm.icerock.dev - настройка окружения</a>.</p>
<p>Основные два рабочих инструмента - Android Studio и Xcode.</p>
<p>В качестве отправной точки мы будем использовать наш шаблоный проект - <strong>mobile-moko-boilerplate</strong>. Он используется на всех новых проектах для быстрого развёртывания и старта разработки. Там уже подключены все минимально необходимые зависимости, имеется нужная структура папок и базовая настройка проекта. Так что заходим на GitLab в репозиторий <a href="https://gitlab.icerockdev.com/scl/boilerplate/mobile-moko-boilerplate" target="_blank">https://gitlab.icerockdev.com/scl/boilerplate/mobile-moko-boilerplate</a> и делаем форк себе в профиль, клонируем.</p>
<p>После клонирования открываем проект в Android Studio. Для этого запускаем студию, File -&gt; Open -&gt; И выбираем папку, в которую склонировали репозиторий. При первом открытии должно появиться следующее:<br><img alt="android studio start" src="img/5d69b1a99ea4bdae.png"></p>
<p>По-умолчанию студия парсит каталоги и строит отображение как для Android-проекта. Но мы здесь будем работать не только с андроидом, но и с мультиплатформой. Поэтому переключаем отображение. Для этого слева нажимаем на выпадашку Android и выбираем вместо него Project:<br><img alt="android studio project" src="img/9c87ccce445d4dce.png"></p>
<p>После этого структура папок немного изменится:<br><img alt="android studio structure" src="img/38aadee1f5157514.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Сборка Android приложения" duration="5">
        <p>Для сборки Android приложения все достаточно просто - достаточно в Android Studio запустить кнопку Run и всё. Также просто как и при обычной разработке Android приложения.</p>
<p class="image-container"><img alt="android studio run" src="img/859d7678486ee309.png"></p>
<p>В результате произойдет сборка android версии общей библиотеки (mpp-library) и android приложения, а после этого приложение запустится на выбранном устройстве / эмуляторе.</p>
<p class="image-container"><img alt="android studio emulator" src="img/6fd44144986ce781.png"></p>


      </google-codelab-step>
    
      <google-codelab-step label="Сборка iOS приложения" duration="10">
        <p>Далее соберём iOS проект. Как именно это сделать можно прочитать тут же в Readme открытого проекта. Но чтобы было нагляднее - пройдём эти незамысловатые шаги для ios-проекта.</p>
<p>Сначала ставим CocoaPods - <code>pod install</code> (в директории <code>ios-app</code>).</p>
<aside class="special"><p>Чтобы не переключаться между IDE и терминалом - можно пользоваться терминалом прямо из студии. Просто жмем снизу на панеле вкладку Terminal<br></p>
</aside>
<p class="image-container"><img alt="pod install" src="img/837afe017c95da1b.png"></p>
<p>После этого в Android Studio справа разворачиваем панель Gradle. Внутри Tasks/cocoapods находим нужную нам таску - <code>syncMultiPlatformLibraryDebugFrameworkIosX64</code>: <img alt="gradle task in android studio" src="img/3386b0f23d2b8247.png"></p>
<p>и запускаем её двойным кликом. Тут придётся немного подождать. А чтобы лучше понять, что сейчас произошло, как эти таски появились и что это за Gradle и слон со стрелкой - идём читать статейку про <a href="https://kmm.icerock.dev/pages/4.1.1-kmm-ios-gradle/" target="_blank">Gradle для айосников на kmm.icerock.dev</a>.</p>
<p>После успешного завершения билда необходимо ещё раз выполнить установку подов. И далее можно запускать Xcode и открывать проект, который лежит по пути <code>ios-app/ios-app.xcworkspace</code>.</p>
<p>Выбираем любой симулятор, жмём Run - проект собирается и запускается. <img alt="ios run result" src="img/8081345a4638cfdc.png"></p>
<aside class="warning"><p>Наиболее частая причина ошибок на этом шаге - неправильная последовательность действий. Если вдруг что-то пошло не так, то проверь, что ты установил поды, выполнил синк, а после этого снова установил поды.</p>
</aside>


      </google-codelab-step>
    
      <google-codelab-step label="Итоги" duration="2">
        <p>И это успех) Мы выкачали и собрали мультиплатформенный проект с нуля. Аналогичным образом происходит работа со всеми другими MPP-проектами в компании. Поэтому когда ты попадёшь на боевой проект, то уже точно будешь знать, как его выкачать из репозитория, собрать и запустить у себя.</p>


      </google-codelab-step>
    
  </google-codelab>

  <script src="https://storage.googleapis.com/codelab-elements/native-shim.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/custom-elements.min.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/prettify.js"></script>
  <script src="https://storage.googleapis.com/codelab-elements/codelab-elements.js"></script>
  <script src="//support.google.com/inapp/api.js"></script>

</body>
</html>
